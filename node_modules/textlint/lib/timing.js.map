{"version":3,"sources":["../src/timing.js"],"names":[],"mappings":"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","file":"timing.js","sourcesContent":["/**\n * @fileoverview Tracks performance of individual rules.\n * @author Brandon Mills\n * @copyright 2014 Brandon Mills. All rights reserved.\n */\n\n\"use strict\";\n\n//------------------------------------------------------------------------------\n// Helpers\n//------------------------------------------------------------------------------\n\n/* istanbul ignore next */\n/**\n * Align the string to left\n * @param {string} str string to evaluate\n * @param {int} len length of the string\n * @param {string} ch delimiter character\n * @returns {string} modified string\n * @private\n */\nfunction alignLeft(str, len, ch) {\n    return str + new Array(len - str.length + 1).join(ch || \" \");\n}\n\n/* istanbul ignore next */\n/**\n * Align the string to right\n * @param {string} str string to evaluate\n * @param {int} len length of the string\n * @param {string} ch delimiter character\n * @returns {string} modified string\n * @private\n */\nfunction alignRight(str, len, ch) {\n    return new Array(len - str.length + 1).join(ch || \" \") + str;\n}\n\n//------------------------------------------------------------------------------\n// Module definition\n//------------------------------------------------------------------------------\n\nvar enabled = !!process.env.TIMING;\n\nvar HEADERS = [\"Rule\", \"Time (ms)\", \"Relative\"];\nvar ALIGN = [alignLeft, alignRight, alignRight];\n\n/* istanbul ignore next */\n/**\n * display the data\n * @param {object} data Data object to be displayed\n * @returns {string} modified string\n * @private\n */\nfunction display(data) {\n    var total = 0;\n    var rows = Object.keys(data)\n        .map(function(key) {\n            var time = data[key];\n            total += time;\n            return [key, time];\n        })\n        .sort(function(a, b) {\n            return b[1] - a[1];\n        })\n        .slice(0, 10);\n\n    rows.forEach(function(row) {\n        row.push((row[1] * 100 / total).toFixed(1) + \"%\");\n        row[1] = row[1].toFixed(3);\n    });\n\n    rows.unshift(HEADERS);\n\n    var widths = [];\n    rows.forEach(function(row) {\n        var len = row.length, i, n;\n        for (i = 0; i < len; i++) {\n            n = row[i].length;\n            if (!widths[i] || n > widths[i]) {\n                widths[i] = n;\n            }\n        }\n    });\n\n    var table = rows.map(function(row) {\n        return row.map(function(cell, index) {\n            return ALIGN[index](cell, widths[index]);\n        }).join(\" | \");\n    });\n    table.splice(1, 0, widths.map(function(w, index) {\n        if (index !== 0 && index !== widths.length - 1) {\n            w++;\n        }\n\n        return ALIGN[index](\":\", w + 1, \"-\");\n    }).join(\"|\"));\n\n    console.log(table.join(\"\\n\"));\n}\n\n/* istanbul ignore next */\nmodule.exports = (function() {\n\n    var data = Object.create(null);\n\n    /**\n     * Time the run\n     * @param {*} key key from the data object\n     * @param {Function} fn function to be called\n     * @returns {Function} function to be executed\n     * @private\n     */\n    function time(key, fn) {\n        if (typeof data[key] === \"undefined\") {\n            data[key] = 0;\n        }\n\n        return function() {\n            var t = process.hrtime();\n            fn.apply(null, Array.prototype.slice.call(arguments));\n            t = process.hrtime(t);\n            data[key] += t[0] * 1e3 + t[1] / 1e6;\n        };\n    }\n\n    if (enabled) {\n        process.on(\"exit\", function() {\n            display(data);\n        });\n    }\n\n    return {\n        time: time,\n        enabled: enabled\n    };\n\n}());\n"]}